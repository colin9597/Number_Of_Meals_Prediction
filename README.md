# <Number_Of_Meals_Prediction>
[DACON] 구내 식당 식수 인원 예측 AI 경진대회 (2021.09)  
- 개인 프로젝트  
- PNU 데이터톤 2021 최우수상
---
## 개발 환경
#### [개발 환경]
- 서버 : Colab
- CPU 2.20GHz 2코어
- 메모리 12GiB
- CUDA 11.2
- Ubuntu 18.04.5 LTS
- Python 3.7.11

#### [데이터 출처]
- 한국토지주택공사(LH) 제공 [link](https://dacon.io/competitions/official/235743/data)
---

## Data
#### [train.csv]
- 중식계, 석식계(식수 인원) 포함
- train.shape : (1205, 12)

#### [test.csv]
- 중식계, 석식계(식수 인원) 미포함
- test.shape : (50, 10)

#### [sample_submission.csv]
- sample_submission.shape : (50, 3)
---

## Preprocessing & EDA
#### [결측치]
- NULL 값은 존재하지 않았지만, 석식이 제공되지 않는 날이 있음(ex. 자기계발의 날, 가정의 날 등)
- 중식은 정상적으로 제공되었기에 석식 모델에서만 제거

#### [산점도 분석]
![산점도](https://user-images.githubusercontent.com/80561963/136307474-029e99ff-d6cf-4a93-aea2-c36a8a6a768e.png) 
- 중식계 <-> 석식계 / 중식계, 석식계 <-> 본사시간외근무명령서승인건수 사이에 약간의 선형관계가 있는 것으로 보여짐.

#### [상관분석]
![상관](https://user-images.githubusercontent.com/80561963/136307622-96f401dd-a46f-44ca-87c7-711616d00ae6.png)
###### 1) 중식계와 석식계 사이에 비교적 강한 양의 상관관계가 있다.
- 점심을 먹은 사람은 저녁도 먹을 가능성이 큼
- 위사람들은 보통 시간을 절약하기 위해 점심과 저녁을 구내 식당에서 해결한다고 판단
- 하지만 메뉴가 마음에 안든다면 밖에서 사먹는 것으로 예상

###### 2) 중식계와 석식계는 각각 본사시간외근무명령서승인건수와 비교적 강한 양의 상관관계가 있다.
- 초과 근무를 하는 경우, 점심과 저녁을 구내 식당에서 해결한다고 판단
- 초과 근무를 하는 경우, 할 일이 많기 때문에 시간을 절약할 필요가 있음

#### [요일별 식수인원]
![요일별](https://user-images.githubusercontent.com/80561963/136308025-04d0d14d-116f-4b5b-9682-e3b97ede8e30.JPG)
- 중식계는 월요일이 가장 많고, 월 -> 화 -> 수 -> 목 -> 금 순임.
- 석식계 또한 월요일이 가장 많으나, 중식계만큼 화요일과 큰 차이는 없고 월 -> 화 -> 목 -> 금 -> 수 순임.
- 대체적으로 석식 식수인원보다 중식 식수인원이 더 많음.
- 저녁은 보통 퇴근하고 집에가서 먹는다고 판단

#### [날짜별 식수인원]
###### 1) 연도별 식수인원
![연도별](https://user-images.githubusercontent.com/80561963/136308746-0a9c8173-1017-47f4-93f2-eac5e25658e9.JPG)
- 코로나 이후, 식수 인원이 줄어들 것으로 예상했으나 오히려 오름
- 코로나 이후, 중식 식수인원을 증가했으나 석식 식수인원은 감소
- 코로나 이후, 밖에 나가서 식사하는 것보다 안에서 빠르게 먹는 것을 선호한다고 판단  
  (단, 점심은 어쩔 수 없으나 저녁은 보통 집에 가서 먹는 것으로 판단)

###### 2) 월별 식수인원
![월별](https://user-images.githubusercontent.com/80561963/136308733-79a21305-dd0d-4aff-a129-a928ffa460e9.JPG)
- 중식과 석식 모두 12월에 식수 인원이 감소 => 연말이라 회식이 많을 것으로 예상

###### 3) 연월별 식수인원
![연월별](https://user-images.githubusercontent.com/80561963/136308752-b85bce0b-eb9a-4517-b0fc-4ea44d023f24.JPG)
- 대체적으로 연도별 비슷한 추세를 보이나, 해가 갈수록 데이터 분포의 차이가 커지는 것으로 판단

#### [파생변수 생성]
###### 1) 현재 본사에 있는 잔류 인원
- 'present' = '본사정원수' - '본사휴가자수' - '본사출장자수' - '현본사소속재택근무자수'
- 현재 잔류 인원 대비, 중식계와 석식계 둘다 절반도 못 미침 => 정원수와 식수인원은 큰 관계가 없어 보임.

###### 2) 날짜
- '일자' 변수를 datetime형으로 변환 후, 요일, 'year', 'month', 'day'를 각각 생성

###### 3) 날씨
- 기상청 사이트에서 날씨 데이터를 수집
- 기온 데이터(temperature.csv)의 결측치는 보간법으로 처리하고 'avg_temp', 'high_temp', 'low_temp' 파생변수 생성
- 강수량 데이터(rainfall.csv)의 결측치는 '0'으로 처리하고 'rainfall' 파생변수 생성

###### 4) 메뉴 정리
- 메뉴 변수의 텍스트 데이터를 정제(불용어 처리, 토큰화, Word2Vec, 패딩) 후 분석에 활용하고자 하였으나 예측 모델에 적용하기가 어려웠음.
- 메뉴에서 밥 종류, 국 종류, 메인 반찬 종류, 서브 반찬 종류들을 각각 뽑아내서 파생변수 생성
- 후에 범주형 변수를 카테고리화 진행
---

## Modeling
- XGBoost 모델을 활용
- 하이퍼파라미터 튜닝을 위해 GridSearch와 Optuna 방법 활용
  => GridSearch 적용시, 시간은 오래 걸리지만 높은 성능을 보여줌.  
  => Optuna 적용시, 시간은 많이 단축하지만 GridSearch 보다는 낮은 성능을 보여줌.(그래도 나름 괜찮은 성능을 보여줌)
